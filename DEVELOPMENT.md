# Writer Prompt 开发指导文档

## 1. 项目概述

Writer Prompt 是一个基于 Flask 的写作辅助系统，旨在帮助作者更好地管理和创作文学作品。系统采用模块化设计，支持多项目管理，并实现模块间数据互通。

## 2. 系统架构

### 2.1 技术栈
- 后端：Flask + SQLAlchemy
- 前端：HTML + CSS + JavaScript
- 数据库：SQLite
- 部署：待定

### 2.2 目录结构
```
writer_prompt/
├── app/
│   ├── models/        # 数据模型
│   │   └── __init__.py
│   ├── routes/        # 路由处理
│   │   ├── main.py
│   │   ├── project.py
│   │   ├── outline.py
│   │   └── content.py
│   ├── static/        # 静态文件
│   │   ├── css/
│   │   └── js/
│   └── templates/     # 页面模板
│       ├── base.html
│       ├── index.html
│       └── project/
├── config.py          # 配置文件
├── requirements.txt   # 依赖列表
└── run.py            # 启动脚本
```

## 3. 功能需求

### 3.1 首页功能
- [x] 检查现有项目列表
- [x] 显示项目卡片视图
- [x] 新建项目入口
- [ ] 项目快速搜索
- [ ] 项目分类过滤
- [ ] 最近访问记录

### 3.2 项目管理
- [x] 创建新项目
  - [x] 基本信息（名称、描述）
  - [x] 项目类型选择
  - [x] 自动创建默认设定模板
- [ ] 项目编辑
  - [ ] 修改项目信息
  - [ ] 项目状态管理
  - [ ] 项目封面图片
- [ ] 项目删除
  - [ ] 回收站功能
  - [ ] 永久删除确认

### 3.3 全文设定模块
- [x] 基础设定框架
  - [x] 类型化设定模板
  - [x] 设定内容保存
- [ ] 世界观设定
  - [ ] 基础背景
  - [ ] 历史年表
  - [ ] 地理环境
  - [ ] 文化习俗
- [ ] 人物设定
  - [ ] 角色信息表
  - [ ] 人物关系图
  - [ ] 角色成长线
- [ ] 其他设定
  - [ ] 魔法体系
  - [ ] 科技水平
  - [ ] 政治制度

### 3.4 纲要生成模块
- [x] 基础纲要管理
  - [x] 创建纲要
  - [x] 编辑纲要
  - [x] 删除纲要
- [ ] 高级功能
  - [ ] 章节树状图
  - [ ] 情节时间线
  - [ ] 多线并行视图
  - [ ] 纲要版本控制
- [ ] 辅助功能
  - [ ] 导入/导出
  - [ ] 纲要模板
  - [ ] 智能建议

### 3.5 正文生成模块
- [x] 基础写作功能
  - [x] 创建内容
  - [x] 编辑内容
  - [x] 删除内容
- [ ] 编辑器功能
  - [ ] 富文本编辑
  - [ ] 自动保存
  - [ ] 版本历史
  - [ ] 字数统计
- [ ] 辅助功能
  - [ ] 写作建议
  - [ ] 情感分析
  - [ ] 风格检查
  - [ ] 语法检查

### 3.6 数据互通
- [ ] 模块间数据关联
  - [ ] 设定引用系统
  - [ ] 纲要关联正文
  - [ ] 人物跟踪
- [ ] 智能提示
  - [ ] 设定提醒
  - [ ] 情节连贯性检查
  - [ ] 人物性格一致性检查

### 3.7 界面设计
- [x] 三栏布局
  - [x] 左侧项目导航
  - [x] 中间主要内容
  - [x] 右侧辅助信息
- [ ] 响应式设计
  - [ ] 移动端适配
  - [ ] 平板端适配
- [ ] 主题系统
  - [ ] 明暗主题
  - [ ] 自定义主题

### 3.8 导出功能
- [ ] 导出格式支持
  - [ ] Markdown
  - [ ] PDF
  - [ ] Word
  - [ ] TXT
- [ ] 导出范围选择
  - [ ] 全文导出
  - [ ] 章节导出
  - [ ] 自定义导出

## 4. 开发计划

### 4.1 第一阶段：基础功能（已完成）
- [x] 项目基础架构
- [x] 数据库设计
- [x] 基础CRUD操作
- [x] 页面模板

### 4.2 第二阶段：核心功能
- [ ] 完善项目管理
- [ ] 设定系统完善
- [ ] 纲要系统增强
- [ ] 编辑器优化

### 4.3 第三阶段：高级功能
- [ ] 数据互通系统
- [ ] 智能提示系统
- [ ] 导出功能
- [ ] 版本控制

### 4.4 第四阶段：优化完善
- [ ] 性能优化
- [ ] UI/UX改进
- [ ] 移动端适配
- [ ] 单元测试

## 5. 开发规范

### 5.1 代码规范
- Python：遵循 PEP 8
- JavaScript：使用 ESLint
- HTML/CSS：遵循 BEM 命名规范

### 5.2 Git 工作流
- 主分支：main
- 开发分支：dev
- 功能分支：feature/*
- 修复分支：hotfix/*

### 5.3 注释规范
- 代码注释：清晰说明功能和参数
- API 文档：使用 docstring
- 变更日志：CHANGELOG.md

## 6. 测试计划

### 6.1 单元测试
- 模型测试
- 路由测试
- 工具函数测试

### 6.2 集成测试
- API 测试
- 数据流测试
- 模块互通测试

### 6.3 UI 测试
- 界面功能测试
- 响应式测试
- 兼容性测试

## 7. 部署说明

### 7.1 环境要求
- Python 3.8+
- SQLite 3
- 现代浏览器

### 7.2 安装步骤
1. 克隆项目
2. 创建虚拟环境
3. 安装依赖
4. 配置数据库
5. 运行应用

### 7.3 更新维护
- 定期备份数据
- 检查依赖更新
- 监控系统状态

## 8. 注意事项

### 8.1 安全考虑
- 数据备份策略
- 用户数据保护
- 输入验证

### 8.2 性能考虑
- 数据库优化
- 缓存策略
- 静态资源处理